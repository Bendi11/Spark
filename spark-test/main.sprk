imp mod:puts
imp mod:structure
type str = *u8
type strbuf = *str

type cb = {
    fun(*u8) -> i32 fn,
}

type str_or_num = i32 | str

fun ext printf(*u8 fmt, *u8 b)

fun test() -> i32 {
    puts("Hi!")
    return 101
}

fun ext main(i32 argc, **u8 argv) -> i32 {
    let callback = #cb {
        fn = $fun(*u8) -> i32 test,
    }
    let testing = test
    let res = ((callback.fn)($*u8 0))
    mod:puts("Hello, World!")
    printf("Callback returned %d\n", $*u8 res)
    printf("Here: %p\n", $*u8 printf)
    return 0
}
